# PKM Bridge Server - Environment Configuration Template
# Copy this file to .env and fill in your values
# IMPORTANT: Never commit .env to version control!
#
# NOTE: Traefik domain is configured in docker-compose.yml labels
#       Update the Host() rule in docker-compose.yml with your domain

# =============================================================================
# API Configuration
# =============================================================================

# Your Anthropic API key (required)
# Get from: https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=sk-ant-xxxxx...

# Default Claude model for new sessions
# Options: claude-haiku-4-5, claude-sonnet-4-5, claude-opus-4-1
MODEL=claude-haiku-4-5

# =============================================================================
# Directory Paths (on Docker host)
# =============================================================================

# Path to your org-mode notes directory (read/write access needed)
# The container needs write access for the add_journal_note tool
ORG_DIR=/path/to/your/org-agenda

# Path to your Logseq notes directory (read-only)
# Leave blank if you don't use Logseq
LOGSEQ_DIR=/path/to/your/Logseq

# =============================================================================
# Authentication & Security
# =============================================================================

# Enable authentication (strongly recommended for production)
AUTH_ENABLED=true

# JWT Secret - Generate with:
# python3 -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET=REPLACE_WITH_GENERATED_SECRET

# Password hash - Generate with:
# python3 -c "import bcrypt; print(bcrypt.hashpw(b'your-password', bcrypt.gensalt(12)).decode())"
# No need to escape $ signs - they're passed directly to the container
PASSWORD_HASH=$2b$12$REPLACE_WITH_GENERATED_HASH

# Token expiry in hours (168 = 1 week)
TOKEN_EXPIRY_HOURS=168

# =============================================================================
# Server Configuration
# =============================================================================

# Server port (container internal - don't change unless needed)
PORT=8000

# Host binding inside container (0.0.0.0 listens on all interfaces)
HOST=0.0.0.0

# Enable debug mode (only for development, not production)
DEBUG=false

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# =============================================================================
# Database Configuration
# =============================================================================

# PostgreSQL database credentials
# These are used by both the database container and the app
DB_USER=pkm
DB_PASSWORD=REPLACE_WITH_SECURE_PASSWORD

# Database URL - use placeholders for automatic password encoding
# The {DB_PASSWORD} placeholder will be automatically URL-encoded
# so special characters like @, %, #, etc. are handled correctly
DATABASE_URL=postgresql://{DB_USER}:{DB_PASSWORD}@localhost:5432/pkm_db

# Note: In Docker, the hostname is 'postgres' instead of 'localhost'
# This is auto-configured in docker-compose.yml

# =============================================================================
# TickTick Integration (Optional)
# =============================================================================

# Register your app at https://developer.ticktick.com/ to get these credentials
# Leave blank to disable TickTick integration

# TickTick OAuth credentials
# Note: If your secret contains # characters, wrap it in quotes
TICKTICK_CLIENT_ID=
TICKTICK_CLIENT_SECRET=

# OAuth redirect URI - must match what you configured in TickTick Developer Portal
# For local dev: http://localhost:8000/auth/ticktick/callback
# For production: https://your-domain.com/auth/ticktick/callback
TICKTICK_REDIRECT_URI=http://localhost:8000/auth/ticktick/callback

# =============================================================================
# Command Execution Security
# =============================================================================

# Whitelist of commands allowed in execute_shell tool
# Comma-separated list, no spaces
# Default includes safe read-only commands
ALLOWED_COMMANDS=date,rg,ripgrep,grep,fd,find,cat,ls,emacs,git,sed,head,tail,wc
